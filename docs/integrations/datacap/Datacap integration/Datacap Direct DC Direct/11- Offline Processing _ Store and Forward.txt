Offline Processing / Store and ForwardStore and Forward (Offline) ProcessingDC Direct is typically deployed in locations with a persistent Internet connection to a payment processor and each transaction request is transmitted in real time for authorization to that processor. However, DC Direct can be configured during installation to optionally perform transaction processing in programmatically controlled offline (SAF - Store and Forward) mode.Offline operation allows DC Direct to continue processing transactions in the event of a processor outage or the absence of working Internet connection to the payment processing service. It is also applicable as a primary mode of operation in situations where connectivity is unavailable while transactions are being submitted, such as some mobile operations.Transactions which are processed offline are collected in encrypted storage by DC Direct and must eventually be settled with the payment processor when an Internet connection is available. After settlement, all offline transactions are securely deleted.By default, DC Direct installations are configured as online only. Offline operation is optional and must be provisioned through Datacap’s PSCS system (Payment System Configuration Server) when DC Direct activation is performed.Store and Forward is supported on PAX Android devices only.Note: <SurchargeWithLookup> does not get stored with Store and Forward transactions.See Store and Forward Errors for a list of error codes returned while in store and forward mode.UsageAn integrator can control aspects of offline operation with optional XML tags included in transaction requests to DC Direct. There are three optional XML tags that an integrator should consider:ElementDescriptionForceOfflineThis is flag allows an integrator to force offline processing of transaction regardless of available Internet connection to a processor if <MaxTransactions> and <OfflineTransactionPurchaseLimit> have not been exceeded. When the Internet connection is down, this tag can be used to reduce extended processing times since network discovery and retries will be avoided.MaxTransactionsThis is the maximum number of transactions which can be captured in offline mode before settlement must be performed (see below).OfflineTransactionPurchaseLimitMaximum transaction amount allowed for offline processing. If purchase amount is greater, then the transaction will/must process online.The PSCS configuration process will establish selected parameters for operation of the optional offline functionality of DC Direct in addition to the per transaction XML tags:PSCS ParameterDescriptionEnable offline operationEnables the optional offline (Store and Forward) capability in DC DirectMaximum stored transaction countThis sets the maximum number of stored offline transactions permitted before offline processing will be halted and settlement must be performed (see below). This count cannot be exceeded by the integrator supplied tag value.Total purchase limit for offline transactionsThis is the net maximum (whole) dollar amount of all stored offline transactions allowed before settlement must be performed. (see below)Maximum time allowed to store offline transactionsThis is the age of the oldest stored offline transaction allowed before settlement must be performed. (see below)The following EMV Transactions are eligible for offline processing:SAF Eligible TransactionsEMVSaleSaleByRecordNoVoidSaleByRecordNoEMVPreAuthIncrementalAuthByRecordNoPartialReversalByRecordNoPreAuthCaptureByRecordNoAdjustByRecordNoEMVReturnReturnByRecordNoVoidReturnVoidReturnByRecordNoEMVVoiceAuthTransaction ExampleBelow is an example EMVSale including the Store and Forward tags followed by a call to SAFStatistics and finally a ForwardAll command.Offline Sale? Offline Sale Request? Offline Sale Response?POST /ProcessEMVTransaction/ HTTP/1.1Host: 192.168.1.232:8080Content-Type: application/xmlContent-Length: 143<?xml version="1.0"?><TStream>    <Transaction>        <MerchantID>DEMODCHALGP</MerchantID>        <POSPackageID>POSNameHere:1.0</POSPackageID>        <TranCode>EMVSale</TranCode>        <InvoiceNo>001</InvoiceNo>        <RefNo>001</RefNo>        <Amount>            <Purchase>1.00</Purchase>        </Amount>        <SequenceNo>0010010010</SequenceNo>        <PartialAuth>Allow</PartialAuth>        <ForceOffline>Y</ForceOffline>        <OfflineTransactionPurchaseLimit>100.00</OfflineTransactionPurchaseLimit>        <MaxTransactions>20</MaxTransactions>    </Transaction></TStream>?SAF Statistics? SAF_Statistics Request? SAF_Statistics Response?POST /ProcessEMVTransaction/ HTTP/1.1Host: 192.168.1.232:8080Content-Type: application/xmlContent-Length: 85<?xml version="1.0"?><TStream>    <Admin>        <MerchantID>DEMODCHALGP</MerchantID>        <POSPackageID>POSNameHere:1.0</POSPackageID>        <TranType>Administrative</TranType>        <TranCode>SAF_Statistics</TranCode>        <SequenceNo>0010010010</SequenceNo>    </Admin></TStream>?SAF ForwardAll? SAF_ForwardAll Request? SAF_ForwardAll Response?POST /ProcessEMVTransaction/ HTTP/1.1Host: 192.168.1.232:8080Content-Type: application/xmlContent-Length: 102<?xml version="1.0"?><TStream>    <Admin>        <MerchantID>DEMODCHALGP</MerchantID>        <POSPackageID>POSNameHere:1.0</POSPackageID>        <TranType>Administrative</TranType>        <TranCode>SAF_ForwardAll</TranCode>        <SequenceNo>0010010010</SequenceNo>    </Admin></TStream>?SettlementWhen any offline transaction limits described above are reached, further offline transactions will be rejected and a settlement process consisting of three Administrative transactions is required before additional offline processing can continue.The process consists of the following Administrative transactions performed in order: 1. SAF_ForwardAll 2. Batch Summary 3. BatchCloseThe Internet connection to the payment processor must be operational during the settlement process. After this settlement process is completed, all offline transactions are securely deleted.